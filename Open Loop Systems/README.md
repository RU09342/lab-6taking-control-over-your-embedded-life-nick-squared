# Lab 6: Open Loop Systems
### Nick Squared

## Overview
Open loop systems are any system that has no feedback. When you set a frequency, the system does not check to see if the frequency is correct, it simply assumes so. For frequency, machines are accurate enough that no feedback is needed for it, but for something as dynamic as temperature, it may lose some accuracy.  This project can demonstrate the accuracy of this open loop temperature control system. To do this, a MSP430FR5994 was used to control a DC fan that would cool off a 5V voltage regulator that was powered with 20V. By doing so, the voltage regulator would convert the excess voltage into heat, and an excess of 15V would be enough to burn the regulator normally, but the fan can cool it off to a reasonable temperature. To set the temperature, simply send the microprocessor the desired temperature in Celcius over UART. To check the temperature, a temperature sensor is attached to the voltage regulator, then the signal gets sent to a PC using the same UART terminal as before. The tmeperature sensor is not used to control the circuit at all, only send the temperature to the user.

## System Configuration
### Voltage Regulator
For the voltage regulator to generate heat, there must be power. A 33 ohm, 1W resistor connected the 5V output to ground, this would generate  around .75W of power, this will be enough heat to provide a nice range of temperatures. 

### DC Fan
The DC fan requires 12V for power, and is controlled by a 5V, 25kHz PWM. The 12V is supplied directly from a power supply, and a CMOS inverter is used to bring a PWM signal up to 5V. The PWM signal is generated by the microprocessor at 3.3V, and is already inverted. The 2 inversions cancel out to provide the 5V PWM the fan needs.

### Temperature Sensor
The temperature sensor is a LM35 powered by the 12V from the fan, and its output gets sent to the ADC on the microprocessor. For accurate data, the LM35 is tied to the heatsink of the voltage regulator using a thin copper wire. The temperature sensor data goes through a UART termainal so the user can read the temperature, in no way does it affect the system.

### Diagrams 
Here is a schematic of the system, as well as a picture of an old version. The only differences between the old version and the current one is that the power resistor is a different value and the copper wire was not there yet.

**Schematic here!**
<img src ="https://github.com/RU09342/lab-6taking-control-over-your-embedded-life-nick-squared/blob/master/Assets/Open%20Loop.jpg" width="300"/>

## Microprocessor
The MSP403FR5994 microprocessor is in charge of the following :
- Reading the user's dersired temperature
- Calculating and controling the fan's PWM duty cycle
- Converting and sending the data from the temperature sensor

Once the user inputs a temperature over the UART terminal, the PWM needed to reach that temperature is calculated by using the following graph.

<img src ="https://github.com/RU09342/lab-6taking-control-over-your-embedded-life-nick-squared/blob/master/Assets/Open%20loop%20graph.png" width="600"/>

This graph is based on a room temperature of 20.5&#176;C, and has a 96% accuracy at that room temperature.

In addition, the microprocessor also is reading the temperature sensor and outputing the data over UART twice per second.  To do this, the voltage based temperature data is put into an internal ADC. The ADC's value is multiplied by a constant to match the temperature, and is then sent over UART. The timing is controlled by a simple timer interrupt set at 2Hz.

## Operation
Once the system is connected, the controls are simple: send the desired temperature to the microprocessor over the same UART as the temperature sensor's output. The microprocessor will calculate the desired PWM and set the fan to it. The ranges for the system are between 37&#176;C and 88&#176;C, if the user attempts to set a range outside of those temperatures, the fan will only go to the end of its range and hold there. The largest error source will be the room temperature, and the user must add the difference between the current room temperature and 20.5&#176;C when sending the desired temperature. If done correctly, the fan can get the to the correct temperature within a few seconds.

